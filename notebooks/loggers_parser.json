{"noteParams":{},"angularObjects":{"sh:shared_process":[],"python3:shared_process":[],"spark:shared_process":[]},"ospInfo":{"owner":"teamloggers","authorizations":[]},"name":"loggers_parser","noteForms":{},"id":"2ENR1CEQX","paragraphs":[{"jobName":"paragraph_1570000164948_1289514837","settings":{"params":{},"forms":{}},"dateFinished":"2019-10-05 13:44:14.772","progressUpdateIntervalMs":500,"dateUpdated":"2019-10-05 13:44:05.936","dateCreated":"2019-10-02 07:09:24.948","dateStarted":"2019-10-05 13:44:05.948","text":"%sh\napt update\ncurl -sS https://bootstrap.pypa.io/get-pip.py >>setup.py\npython3 setup.py\npip3 install pandas\npip3 install --upgrade onesaitplatform-client-services\npip3 install watchdog","id":"20191002-070924_324989310","user":"user1","config":{"tableHide":false,"editorSetting":{"completionSupport":false,"language":"sh","completionKey":"TAB","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/sh","fontSize":9,"editorHide":false,"results":{},"enabled":true},"results":{"msg":[{"data":"\nWARNING: apt does not have a stable CLI interface. Use with caution in scripts.\n\nGet:1 http://security.ubuntu.com/ubuntu xenial-security InRelease [109 kB]\nHit:2 http://cran.rstudio.com/bin/linux/ubuntu xenial/ InRelease\nHit:3 http://archive.ubuntu.com/ubuntu xenial InRelease\nHit:4 http://archive.ubuntu.com/ubuntu xenial-updates InRelease\nGet:5 http://archive.ubuntu.com/ubuntu xenial-backports InRelease [107 kB]\nFetched 216 kB in 0s (350 kB/s)\nReading package lists...\nBuilding dependency tree...\nReading state information...\n185 packages can be upgraded. Run 'apt list --upgradable' to see them.\nCollecting pip\n  Using cached https://files.pythonhosted.org/packages/30/db/9e38760b32e3e7f40cce46dd5fb107b8c73840df38f0046d8e6514e675a1/pip-19.2.3-py2.py3-none-any.whl\nInstalling collected packages: pip\n  Found existing installation: pip 19.2.3\n    Uninstalling pip-19.2.3:\n      Successfully uninstalled pip-19.2.3\nSuccessfully installed pip-19.2.3\nRequirement already satisfied: pandas in /usr/local/lib/python3.5/dist-packages (0.24.2)\nRequirement already satisfied: pytz>=2011k in /usr/local/lib/python3.5/dist-packages (from pandas) (2019.2)\nRequirement already satisfied: python-dateutil>=2.5.0 in /usr/local/lib/python3.5/dist-packages (from pandas) (2.8.0)\nRequirement already satisfied: numpy>=1.12.0 in /usr/local/lib/python3.5/dist-packages (from pandas) (1.17.2)\nRequirement already satisfied: six>=1.5 in /usr/local/lib/python3.5/dist-packages (from python-dateutil>=2.5.0->pandas) (1.12.0)\nRequirement already up-to-date: onesaitplatform-client-services in /usr/local/lib/python3.5/dist-packages (1.2.3)\nRequirement already satisfied, skipping upgrade: paho-mqtt in /usr/local/lib/python3.5/dist-packages (from onesaitplatform-client-services) (1.4.0)\nRequirement already satisfied, skipping upgrade: requests in /usr/local/lib/python3.5/dist-packages (from onesaitplatform-client-services) (2.22.0)\nRequirement already satisfied, skipping upgrade: six in /usr/local/lib/python3.5/dist-packages (from onesaitplatform-client-services) (1.12.0)\nRequirement already satisfied, skipping upgrade: certifi>=2017.4.17 in /usr/local/lib/python3.5/dist-packages (from requests->onesaitplatform-client-services) (2019.9.11)\nRequirement already satisfied, skipping upgrade: chardet<3.1.0,>=3.0.2 in /usr/local/lib/python3.5/dist-packages (from requests->onesaitplatform-client-services) (3.0.4)\nRequirement already satisfied, skipping upgrade: idna<2.9,>=2.5 in /usr/local/lib/python3.5/dist-packages (from requests->onesaitplatform-client-services) (2.8)\nRequirement already satisfied, skipping upgrade: urllib3!=1.25.0,!=1.25.1,<1.26,>=1.21.1 in /usr/local/lib/python3.5/dist-packages (from requests->onesaitplatform-client-services) (1.25.6)\nRequirement already satisfied: watchdog in /usr/local/lib/python3.5/dist-packages (0.9.0)\nRequirement already satisfied: pathtools>=0.1.1 in /usr/local/lib/python3.5/dist-packages (from watchdog) (0.1.2)\nRequirement already satisfied: PyYAML>=3.10 in /usr/local/lib/python3.5/dist-packages (from watchdog) (5.1.2)\nRequirement already satisfied: argh>=0.24.1 in /usr/local/lib/python3.5/dist-packages (from watchdog) (0.26.2)\n","type":"TEXT"}],"code":"SUCCESS"},"apps":[],"status":"FINISHED"},{"jobName":"paragraph_1569958486255_853767559","settings":{"params":{},"forms":{}},"dateFinished":"2019-10-08 09:08:27.115","progressUpdateIntervalMs":500,"dateUpdated":"2019-10-08 09:08:26.988","dateCreated":"2019-10-01 19:34:46.255","dateStarted":"2019-10-08 09:08:27.024","text":"%sh\n# ls teamloggers\n# ls /tmp/logs | egrep -o '([[:alpha:]]+\\-*)*' | awk '{count[$1]++} END {for (word in count) print word, count[word]}' | grep onesait\nls /tmp/logs | grep onesaitplatform-semantic-inf-broker-2019-10-08\n\nhead -n100 /tmp/logs/onesaitplatform-semantic-inf-broker-2019-10-08-11_69.log\n\n","id":"20191001-193446_1417090540","user":"user1","config":{"tableHide":false,"editorSetting":{"completionSupport":false,"language":"sh","completionKey":"TAB","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/sh","fontSize":9,"editorHide":false,"results":{},"enabled":true},"results":{"msg":[{"data":"onesaitplatform-semantic-inf-broker-2019-10-08-11_69.log\nonesaitplatform-semantic-inf-broker-2019-10-08-11_70.log\nonesaitplatform-semantic-inf-broker-2019-10-08-11_71.log\nonesaitplatform-semantic-inf-broker-2019-10-08-11_72.log\nonesaitplatform-semantic-inf-broker-2019-10-08-11_73.log\nonesaitplatform-semantic-inf-broker 06:55:11.940 [qtp1728924984-6073] dbff219d-094b-44ab-a0ec-46d9239f258c INFO  c.m.o.platform.persistence.http.BaseHttpClient - Send message: to http://quasar:10800/compile/fs/onesaitplatform_rtdb/?q=select+count%28WRT_lugarsensor%29+from+WRT_lugarsensor+where+WRT_lugarsensor.WRT_lugarsensor.room%3D%22DespachoG%22&limit=2000.\nonesaitplatform-semantic-inf-broker 06:55:11.941 [qtp1728924984-6073] dbff219d-094b-44ab-a0ec-46d9239f258c INFO  c.m.o.p.p.m.q.connector.QuasarMongoDBbHttpImpl - Quasar is about to execute native query: db.WRT_lugarsensor.aggregate(  [    {      \"$match\": {        \"$and\": [          { \"WRT_lugarsensor\": { \"$type\": NumberInt(\"3\") } },          { \"WRT_lugarsensor.room\": \"DespachoG\" }]      }    },    {      \"$group\": {        \"__tmp2\": { \"$sum\": { \"$literal\": NumberInt(\"1\") } },        \"_id\": { \"$literal\": null }      }    },    { \"$limit\": NumberLong(\"2000\") },    { \"$project\": { \"value\": \"$__tmp2\", \"_id\": false } }],  { \"allowDiskUse\": true });\nonesaitplatform-semantic-inf-broker 06:55:11.953 [qtp1728924984-6047] 1d39859f-537f-4278-80ec-84fc1db3a1c5 INFO  c.m.o.platform.persistence.http.BaseHttpClient - Send message: to http://quasar:10800/compile/fs/onesaitplatform_rtdb/?q=select+*+from+D_customers_information_2+as+c+where+c.id+%3D+10002&limit=2000.\nonesaitplatform-semantic-inf-broker 06:55:11.953 [qtp1728924984-6047] 1d39859f-537f-4278-80ec-84fc1db3a1c5 INFO  c.m.o.p.p.m.q.connector.QuasarMongoDBbHttpImpl - Quasar is about to execute native query: db.D_customers_information_2.find({ \"id\": NumberInt(\"10002\") }).limit(2000);\nonesaitplatform-semantic-inf-broker 06:55:11.959 [qtp1728924984-5913] e37d3989-37e8-413b-8593-b3da84e5e98a INFO  c.m.o.platform.persistence.http.BaseHttpClient - Send message: to http://quasar:10800/compile/fs/onesaitplatform_rtdb/?q=select+count%28WRT_lugarsensor%29+from+WRT_lugarsensor+where+WRT_lugarsensor.WRT_lugarsensor.room%3D%22Despacho4%22&limit=2000.\nonesaitplatform-semantic-inf-broker 06:55:11.959 [qtp1728924984-5913] e37d3989-37e8-413b-8593-b3da84e5e98a INFO  c.m.o.p.p.m.q.connector.QuasarMongoDBbHttpImpl - Quasar is about to execute native query: db.WRT_lugarsensor.aggregate(  [    {      \"$match\": {        \"$and\": [          { \"WRT_lugarsensor\": { \"$type\": NumberInt(\"3\") } },          { \"WRT_lugarsensor.room\": \"Despacho4\" }]      }    },    {      \"$group\": {        \"__tmp2\": { \"$sum\": { \"$literal\": NumberInt(\"1\") } },        \"_id\": { \"$literal\": null }      }    },    { \"$limit\": NumberLong(\"2000\") },    { \"$project\": { \"value\": \"$__tmp2\", \"_id\": false } }],  { \"allowDiskUse\": true });\nonesaitplatform-semantic-inf-broker 06:55:12.046 [qtp1728924984-6063] 2b699ca2-66e4-4436-90f7-5f4c5bb78291 INFO  c.m.o.platform.interceptor.CorrelationInterceptor - New request with address: 10.42.247.139 , URL:http://routerservice:20000/router/router/insert , User-Agent: Apache-HttpClient/4.5.3 (Java/1.8.0_191) , has id: 2b699ca2-66e4-4436-90f7-5f4c5bb78291 \nonesaitplatform-semantic-inf-broker 06:55:12.047 [qtp1728924984-6063] 2b699ca2-66e4-4436-90f7-5f4c5bb78291 INFO  c.m.o.p.router.controller.RouterControllerImpl - insert:\nonesaitplatform-semantic-inf-broker 06:55:12.069 [qtp1728924984-5804] c45db181-de31-44ef-8698-fcc983073ed5 INFO  c.m.o.platform.interceptor.CorrelationInterceptor - New request with address: 10.42.247.139 , URL:http://routerservice:20000/router/router/insert , User-Agent: Apache-HttpClient/4.5.3 (Java/1.8.0_191) , has id: c45db181-de31-44ef-8698-fcc983073ed5 \nonesaitplatform-semantic-inf-broker 06:55:12.069 [qtp1728924984-5804] c45db181-de31-44ef-8698-fcc983073ed5 INFO  c.m.o.p.router.controller.RouterControllerImpl - insert:\nonesaitplatform-semantic-inf-broker 06:55:12.086 [qtp1728924984-6063] 2b699ca2-66e4-4436-90f7-5f4c5bb78291 INFO  c.m.o.platform.audit.producer.Sofia2EventProducer - Sofia2EventProducer :: thread 'Thread[qtp1728924984-6063,5,main]' handling 'operation for Ontology : AnimalOntology_Zoo Type : POST By User : marianneaymard Has a Response: OK' publish Event to Application Event Publisher: \nonesaitplatform-semantic-inf-broker 06:55:12.086 [taskExecutor-1]  INFO  c.m.o.platform.audit.listener.Sofia2EventListener - Sofia2EventListener :: Default Event Processing detected : thread 'DATA' handling 'operation for Ontology : AnimalOntology_Zoo Type : POST By User : marianneaymard Has a Response: OK' async event\nonesaitplatform-semantic-inf-broker 06:55:12.086 [taskExecutor-1]  INFO  c.m.o.platform.audit.listener.Sofia2EventListener - {\"message\":\"operation for Ontology : AnimalOntology_Zoo Type : POST By User : marianneaymard Has a Response: OK\",\"id\":\"dab7f4f7-4730-4682-8a2a-9111d3edab3e\",\"type\":\"DATA\",\"timeStamp\":1570517712086,\"formatedTimeStamp\":\"2019-10-08T06:55:12.086Z\",\"user\":\"marianneaymard\",\"ontology\":\"AnimalOntology_Zoo\",\"operationType\":\"POST\"}\nonesaitplatform-semantic-inf-broker 06:55:12.089 [qtp1728924984-6063] 2b699ca2-66e4-4436-90f7-5f4c5bb78291 INFO  c.m.o.p.router.controller.RouterControllerImpl - Processed Insert operation in: 42\nonesaitplatform-semantic-inf-broker 06:55:12.100 [qtp1728924984-6068] cd18a25e-3ea5-4712-a8b4-6645513e8b6d INFO  c.m.o.platform.interceptor.CorrelationInterceptor - New request with address: 10.42.247.139 , URL:http://routerservice:20000/router/router/insert , User-Agent: Apache-HttpClient/4.5.3 (Java/1.8.0_191) , has id: cd18a25e-3ea5-4712-a8b4-6645513e8b6d \nonesaitplatform-semantic-inf-broker 06:55:12.100 [qtp1728924984-6068] cd18a25e-3ea5-4712-a8b4-6645513e8b6d INFO  c.m.o.p.router.controller.RouterControllerImpl - insert:\nonesaitplatform-semantic-inf-broker 06:55:12.124 [qtp1728924984-5906] 0c5742ca-9c2d-4af0-9d4b-a2d4a94c0b4c INFO  c.m.o.platform.interceptor.CorrelationInterceptor - New request with address: 10.42.247.139 , URL:http://routerservice:20000/router/router/insert , User-Agent: Apache-HttpClient/4.5.3 (Java/1.8.0_191) , has id: 0c5742ca-9c2d-4af0-9d4b-a2d4a94c0b4c \nonesaitplatform-semantic-inf-broker 06:55:12.124 [qtp1728924984-5906] 0c5742ca-9c2d-4af0-9d4b-a2d4a94c0b4c INFO  c.m.o.p.router.controller.RouterControllerImpl - insert:\nonesaitplatform-semantic-inf-broker 06:55:12.160 [qtp1728924984-6067] 519f88d9-b304-4dcb-8fe8-2440565bc352 INFO  c.m.o.platform.interceptor.CorrelationInterceptor - New request with address: 10.42.247.139 , URL:http://routerservice:20000/router/router/insert , User-Agent: Apache-HttpClient/4.5.3 (Java/1.8.0_191) , has id: 519f88d9-b304-4dcb-8fe8-2440565bc352 \nonesaitplatform-semantic-inf-broker 06:55:12.160 [qtp1728924984-6067] 519f88d9-b304-4dcb-8fe8-2440565bc352 INFO  c.m.o.p.router.controller.RouterControllerImpl - insert:\nonesaitplatform-semantic-inf-broker 06:55:12.162 [qtp1728924984-6068] cd18a25e-3ea5-4712-a8b4-6645513e8b6d INFO  c.m.o.platform.audit.producer.Sofia2EventProducer - Sofia2EventProducer :: thread 'Thread[qtp1728924984-6068,5,main]' handling 'operation for Ontology : TempSensorJ Type : POST By User : jjrodriguezv Has a Response: OK' publish Event to Application Event Publisher: \nonesaitplatform-semantic-inf-broker 06:55:12.162 [qtp1728924984-5804] c45db181-de31-44ef-8698-fcc983073ed5 INFO  c.m.o.platform.audit.producer.Sofia2EventProducer - Sofia2EventProducer :: thread 'Thread[qtp1728924984-5804,5,main]' handling 'operation for Ontology : SmartCityDemo Type : POST By User : vcabezas Has a Response: OK' publish Event to Application Event Publisher: \nonesaitplatform-semantic-inf-broker 06:55:12.162 [qtp1728924984-5906] 0c5742ca-9c2d-4af0-9d4b-a2d4a94c0b4c INFO  c.m.o.platform.audit.producer.Sofia2EventProducer - Sofia2EventProducer :: thread 'Thread[qtp1728924984-5906,5,main]' handling 'operation for Ontology : WRT_temperatures1 Type : POST By User : evelynand Has a Response: OK' publish Event to Application Event Publisher: \nonesaitplatform-semantic-inf-broker 06:55:12.162 [taskExecutor-1]  INFO  c.m.o.platform.audit.listener.Sofia2EventListener - Sofia2EventListener :: Default Event Processing detected : thread 'DATA' handling 'operation for Ontology : TempSensorJ Type : POST By User : jjrodriguezv Has a Response: OK' async event\nonesaitplatform-semantic-inf-broker 06:55:12.162 [taskExecutor-1]  INFO  c.m.o.platform.audit.listener.Sofia2EventListener - {\"message\":\"operation for Ontology : TempSensorJ Type : POST By User : jjrodriguezv Has a Response: OK\",\"id\":\"372cb4c5-a083-4873-b490-ab88b7e6a466\",\"type\":\"DATA\",\"timeStamp\":1570517712162,\"formatedTimeStamp\":\"2019-10-08T06:55:12.162Z\",\"user\":\"jjrodriguezv\",\"ontology\":\"TempSensorJ\",\"operationType\":\"POST\"}\nonesaitplatform-semantic-inf-broker 06:55:12.162 [taskExecutor-1]  INFO  c.m.o.platform.audit.listener.Sofia2EventListener - Sofia2EventListener :: Default Event Processing detected : thread 'DATA' handling 'operation for Ontology : SmartCityDemo Type : POST By User : vcabezas Has a Response: OK' async event\nonesaitplatform-semantic-inf-broker 06:55:12.163 [taskExecutor-1]  INFO  c.m.o.platform.audit.listener.Sofia2EventListener - {\"message\":\"operation for Ontology : SmartCityDemo Type : POST By User : vcabezas Has a Response: OK\",\"id\":\"9c5d1798-306d-4043-9021-6f9551714070\",\"type\":\"DATA\",\"timeStamp\":1570517712162,\"formatedTimeStamp\":\"2019-10-08T06:55:12.162Z\",\"user\":\"vcabezas\",\"ontology\":\"SmartCityDemo\",\"operationType\":\"POST\"}\nonesaitplatform-semantic-inf-broker 06:55:12.163 [taskExecutor-1]  INFO  c.m.o.platform.audit.listener.Sofia2EventListener - Sofia2EventListener :: Default Event Processing detected : thread 'DATA' handling 'operation for Ontology : WRT_temperatures1 Type : POST By User : evelynand Has a Response: OK' async event\nonesaitplatform-semantic-inf-broker 06:55:12.163 [taskExecutor-1]  INFO  c.m.o.platform.audit.listener.Sofia2EventListener - {\"message\":\"operation for Ontology : WRT_temperatures1 Type : POST By User : evelynand Has a Response: OK\",\"id\":\"a01dc541-360f-4c7d-979c-bfeddec1727d\",\"type\":\"DATA\",\"timeStamp\":1570517712162,\"formatedTimeStamp\":\"2019-10-08T06:55:12.162Z\",\"user\":\"evelynand\",\"ontology\":\"WRT_temperatures1\",\"operationType\":\"POST\"}\nonesaitplatform-semantic-inf-broker 06:55:12.165 [qtp1728924984-6067] 519f88d9-b304-4dcb-8fe8-2440565bc352 ERROR c.m.o.p.r.s.app.service.crud.RouterCrudServiceImpl - Error validating Schema of the Ontology\ncom.minsait.onesait.platform.config.services.ontologydata.DataSchemaValidationException: Error processing data:{\"DeviceLog\":{\"location\":{\"coordinates\":{\"latitude\":11.0,\"longitude\":11.0},\"type\":\"aaa\"},\"status\":\"true\",\"level\":\"aaaa\",\"message\":\"aaaa\",\"extraOptions\":\"aa\",\"device\":\"contioning\",\"timestamp\":\"2019-09-03T03:45:01.555Z\"}}by:{\"level\":\"error\",\"schema\":{\"loadingURI\":\"#\",\"pointer\":\"/datos/properties/location/properties/type\"},\"instance\":{\"pointer\":\"/DeviceLog/location/type\"},\"domain\":\"validation\",\"keyword\":\"enum\",\"message\":\"instance value (\\\"aaa\\\") not found in enum (possible values: [\\\"Point\\\"])\",\"value\":\"aaa\",\"enum\":[\"Point\"]}\n\tat com.minsait.onesait.platform.config.services.ontologydata.OntologyDataServiceImpl.checkJsonCompliantWithSchema(OntologyDataServiceImpl.java:122)\n\tat com.minsait.onesait.platform.config.services.ontologydata.OntologyDataServiceImpl.checkOntologySchemaCompliance(OntologyDataServiceImpl.java:97)\n\tat com.minsait.onesait.platform.config.services.ontologydata.OntologyDataServiceImpl.preProcessInsertData(OntologyDataServiceImpl.java:421)\n\tat com.minsait.onesait.platform.router.service.app.service.crud.RouterCrudServiceImpl.insert(RouterCrudServiceImpl.java:108)\n\tat com.minsait.onesait.platform.router.service.app.service.crud.RouterCrudServiceImpl$$FastClassBySpringCGLIB$$e85d42a6.invoke(<generated>)\n\tat org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:204)\n\tat org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:738)\n\tat org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:157)\n\tat org.springframework.aop.framework.adapter.AfterReturningAdviceInterceptor.invoke(AfterReturningAdviceInterceptor.java:52)\n\tat org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:168)\n\tat org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:92)\n\tat org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)\n\tat org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:673)\n\tat com.minsait.onesait.platform.router.service.app.service.crud.RouterCrudServiceImpl$$EnhancerBySpringCGLIB$$b7d00d22.insert(<generated>)\n\tat com.minsait.onesait.platform.router.service.processor.RouterFlowManagerService.executeCrudOperations(RouterFlowManagerService.java:203)\n\tat com.minsait.onesait.platform.router.service.processor.RouterFlowManagerService.startBrokerFlow(RouterFlowManagerService.java:140)\n\tat com.minsait.onesait.platform.router.service.app.service.RouterServiceImpl.insert(RouterServiceImpl.java:46)\n\tat com.minsait.onesait.platform.router.service.app.service.RouterServiceImpl$$FastClassBySpringCGLIB$$63899ea4.invoke(<generated>)\n\tat org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:204)\n\tat org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:669)\n\tat com.minsait.onesait.platform.router.service.app.service.RouterServiceImpl$$EnhancerBySpringCGLIB$$ad5a8fe0.insert(<generated>)\n\tat com.minsait.onesait.platform.router.controller.RouterControllerImpl.insert(RouterControllerImpl.java:75)\n\tat com.minsait.onesait.platform.router.controller.RouterControllerImpl$$FastClassBySpringCGLIB$$1ede114e.invoke(<generated>)\n\tat org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:204)\n\tat org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:738)\n\tat org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:157)\n\tat org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:92)\n\tat org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)\n\tat org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:673)\n\tat com.minsait.onesait.platform.router.controller.RouterControllerImpl$$EnhancerBySpringCGLIB$$7154e21a.insert(<generated>)\n\tat sun.reflect.GeneratedMethodAccessor183.invoke(Unknown Source)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n\tat java.lang.reflect.Method.invoke(Method.java:498)\n\tat org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)\n\tat org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:133)\n\tat org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:97)\n\tat org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:827)\n\tat org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:738)\n\tat org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:85)\n\tat org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:967)\n\tat org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:901)\n\tat org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:970)\n\tat org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:872)\n\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:707)\n\tat org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:846)\n\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:790)\n\tat org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:841)\n\tat org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1650)\n\tat org.eclipse.jetty.websocket.server.WebSocketUpgradeFilter.doFilter(WebSocketUpgradeFilter.java:206)\n\tat org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1637)\n\tat org.springframework.boot.web.filter.ApplicationContextHeaderFilter.doFilterInternal(ApplicationContextHeaderFilter.java:55)\n\tat org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)\n\tat org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1637)\n\tat org.springframework.boot.actuate.trace.WebRequestTraceFilter.doFilterInternal(WebRequestTraceFilter.java:110)\n\tat org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)\n\tat org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1637)\n\tat org.springframework.security.web.FilterChainProxy.doFilterInternal(FilterChainProxy.java:208)\n\tat org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:177)\n\tat org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:347)\n\tat org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:263)\n\tat org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1637)\n\tat org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:99)\n\tat org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)\n\tat org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1637)\n\tat org.springframework.web.filter.HttpPutFormContentFilter.doFilterInternal(HttpPutFormContentFilter.java:108)\n\tat org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)\n\tat org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1637)\n\tat org.springframework.web.filter.HiddenHttpMethodFilter.doFilterInternal(HiddenHttpMethodFilter.java:81)\n\tat org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)\n","type":"TEXT"}],"code":"SUCCESS"},"apps":[],"status":"FINISHED"},{"jobName":"paragraph_1570278173021_888798038","settings":{"params":{},"forms":{}},"dateFinished":"2019-10-07 18:01:59.612","progressUpdateIntervalMs":500,"dateUpdated":"2019-10-07 18:01:59.203","dateCreated":"2019-10-05 12:22:53.021","dateStarted":"2019-10-07 18:01:59.259","text":"%python3\nimport pandas as pd\nimport os\nimport watchdog\nimport re","id":"20191005-122253_1257281820","user":"user1","config":{"editorSetting":{"completionSupport":true,"language":"python","completionKey":"TAB","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"results":{"msg":[],"code":"SUCCESS"},"apps":[],"status":"FINISHED"},{"jobName":"paragraph_1570105883402_1894326691","settings":{"params":{},"forms":{}},"dateFinished":"2019-10-07 18:02:00.710","progressUpdateIntervalMs":500,"dateUpdated":"2019-10-07 18:02:00.620","dateCreated":"2019-10-03 12:31:23.402","dateStarted":"2019-10-07 18:02:00.670","text":"%python3\n\n# Get log filenames and classify them\n\n#  filename pattern\nfilename_regex = re.compile('^(?P<source>[\\w-]+?)-(?P<date>\\d{4}-\\d{2}-\\d{2}).*\\.log$')\n\n#  generator iterating over log files that matches the filename_regex pattern and prefix\ndef iter_files(log_path='/tmp/logs', prefix='onesaitplatform'):\n    for file in os.listdir(log_path):\n        filename_data = filename_regex.match(file) if file.startswith(prefix) else None\n        if filename_data is not None:\n            filename_data = filename_data.groupdict()\n            yield filename_data, file\n\n# Save and classify logs\nonesait_logs = dict()\nfor file_data, file in iter_files():\n    onesait_logs.setdefault(file_data['source'], dict()).setdefault(file_data['date'], []).append(file)\nprint(onesait_logs.keys())","id":"20191003-123123_883804872","user":"user1","config":{"tableHide":false,"editorSetting":{"completionSupport":true,"language":"python","completionKey":"TAB","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"editorHide":false,"results":{},"enabled":true},"results":{"msg":[{"data":"dict_keys(['onesaitplatform-oauth-server', 'onesaitplatform-semantic-inf-broker', 'onesaitplatform-rtdb-maintainer', 'onesaitplatform-device-simulator', 'onesaitplatform-iot-broker', 'onesaitplatform-flow-engine', 'onesaitplatform-digitaltwin-broker', 'onesaitplatform-api-manager', 'onesaitplatform-monitoring-ui', 'onesaitplatform-dashboard-engine', 'onesaitplatform-control-panel'])\n","type":"TEXT"}],"code":"SUCCESS"},"apps":[],"status":"FINISHED"},{"jobName":"paragraph_1569948492860_1111172124","settings":{"params":{},"forms":{}},"dateFinished":"2019-10-07 18:18:45.122","progressUpdateIntervalMs":500,"dateUpdated":"2019-10-08 07:27:52.061","dateCreated":"2019-10-01 16:48:12.860","dateStarted":"2019-10-07 18:18:44.859","text":"%python3\n\n# Dump logs into ontology\n\nfrom onesaitplatform.iotbroker import DigitalClient\n\nHOST = 'lab.onesaitplatform.com'\nPORT = 443\nIOT_CLIENT = 'loggers_severity'\nIOT_CLIENT_TOKEN = '5d8f8001f6384d4da6a2a76836a7ac53'\nSEVERITY_ONTOLOGY = 'loggers_severity'\n\nlog_path = '/tmp/logs'\n\n# Event pattern\nevent_regex = re.compile('(?P<source>[\\w-]+) (?P<ts_raw>(?P<hour>\\d{2}):(?P<minute>\\d{2}):\\d{2}\\.\\d+) \\[.+?\\] (?P<severity>\\w+)\\s')\n\n# DigitalClient init\nclient = DigitalClient(HOST, port=PORT, iot_client=IOT_CLIENT, iot_client_token=IOT_CLIENT_TOKEN)\nclient.join()\n\nevents = list()\nfor component, dates in onesait_logs.items():\n    df = pd.DataFrame()\n    for date in dates:\n        for file in dates[date]:\n            file_data = {'component': component, 'date': date}\n            if os.path.isfile(os.path.join(log_path, file)):\n                with open(os.path.join(log_path, file), 'r') as log_fd:\n                    for line in log_fd:\n                        event_data = event_regex.match(line)\n                        if event_data is not None:\n                            events.append({**file_data, **event_data.groupdict()})\n    # df = pd.DataFrame(events).groupby(['component', 'source', 'severity', 'hour']).size().reset_index().rename(columns={0: 'counter'})\n    # df['timestamp'] = df.date + 'T' + df.hour + ':00:00Z'\n    df = pd.DataFrame(events)\n    if not df.empty:\n        df = df.groupby(['component', 'source', 'severity', 'hour', 'date']).size().reset_index().groupby(['severity', 'hour']).quantile(0.9).reset_index().rename(columns={0: 'quantile'})\n        df = df[df['severity'].isin(['INFO', 'ERROR', 'WARN', 'DEBUG'])]\n        ok_query, results_query = client.insert(ontology=\"loggers_severity\", list_data=[{'loggers_severity': data} for data in df.to_dict('records')])\n\nclient.leave()\n","id":"20191001-164812_846054616","user":"user1","config":{"tableHide":false,"editorSetting":{"completionSupport":true,"language":"python","completionKey":"TAB","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"editorHide":false,"results":{"0":{"helium":{},"graph":{"mode":"table","optionOpen":false,"keys":[{"name":"source","index":0,"aggr":"sum"}],"values":[{"name":"timestamp","index":1,"aggr":"sum"}],"commonSetting":{},"groups":[],"height":300,"setting":{"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"lineChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"table":{"initialized":false,"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"showAggregationFooter":false,"showPagination":false,"useFilter":false},"tableGridState":{"scrollFocus":{},"treeView":{},"pagination":{"paginationCurrentPage":1,"paginationPageSize":250},"selection":[],"columns":[{"pinned":"","visible":true,"name":"component","width":"*","sort":{},"filters":[{}]},{"pinned":"","visible":true,"name":"source","width":"*","sort":{},"filters":[{}]},{"pinned":"","visible":true,"name":"severity","width":"*","sort":{},"filters":[{}]},{"pinned":"","visible":true,"name":"date","width":"*","sort":{},"filters":[{}]},{"pinned":"","visible":true,"name":"hour","width":"*","sort":{},"filters":[{}]},{"pinned":"","visible":true,"name":"minute","width":"*","sort":{},"filters":[{}]},{"pinned":"","visible":true,"name":"counter","width":"*","sort":{},"filters":[{}]}],"grouping":{"rowExpandedStates":{},"grouping":[],"aggregations":[]}},"tableColumnTypeState":{"names":{"severity":"string","date":"string","component":"string","hour":"string","source":"string","counter":"string","minute":"string"},"updated":false},"updated":false},"stackedAreaChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}}}}},"enabled":true},"results":{"msg":[{"data":"Info - IotBrokerClient will be soon deprecated, please use DigitalClient instead\nFalse\n(True, '{\"message\":\"Disconnected\"}')\n","type":"TEXT"}],"code":"SUCCESS"},"apps":[],"status":"FINISHED"},{"jobName":"paragraph_1570436501240_389730442","settings":{"params":{},"forms":{}},"dateFinished":"2019-10-07 08:24:23.474","progressUpdateIntervalMs":500,"dateUpdated":"2019-10-07 08:24:17.038","dateCreated":"2019-10-07 08:21:41.240","dateStarted":"2019-10-07 08:24:17.066","text":"%python3\nimport re\n\n# Dump logs into ontology\n\nfrom onesaitplatform.iotbroker import DigitalClient\n\nHOST = 'lab.onesaitplatform.com'\nPORT = 443\nIOT_CLIENT = 'loggers_severity'\nIOT_CLIENT_TOKEN = '5d8f8001f6384d4da6a2a76836a7ac53'\nSEVERITY_ONTOLOGY = 'loggers_severity'\n\nlog_path = '/tmp/logs'\n\n# Event pattern\nevent_regex = re.compile('(?P<source>[\\w-]+) (?P<ts_raw>(?P<hour>\\d{2}):(?P<minute>\\d{2}):\\d{2}\\.\\d+) \\[.+?\\] (?P<severity>\\w+)\\s')\n\n# DigitalClient init\nclient = DigitalClient(HOST, port=PORT, iot_client=IOT_CLIENT, iot_client_token=IOT_CLIENT_TOKEN)\nclient.join()\nok_query, results_query = client.query(ontology=\"loggers_severity\", query=\"DELETE FROM loggers_severity\", query_type=\"SQL\")\nprint(ok_query, results_query)\nclient.leave()\n","id":"20191007-082141_137255238","user":"user1","config":{"editorSetting":{"completionSupport":true,"language":"python","completionKey":"TAB","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"results":{"msg":[{"data":"Info - IotBrokerClient will be soon deprecated, please use DigitalClient instead\nWARNING:onesaitplatform.iotbroker.digitalclient:Response: 400 - com.minsait.onesait.platform.persistence.exceptions.DBPersistenceException: com.mongodb.MongoSocketReadTimeoutException: Timeout while receiving message\nERROR:onesaitplatform.iotbroker.digitalclient:Not possible to query iot-broker: 0\nFalse 0\n(True, '{\"message\":\"Disconnected\"}')\n","type":"TEXT"}],"code":"SUCCESS"},"apps":[],"status":"FINISHED"}],"config":{"isZeppelinNotebookCronEnable":false},"info":{}}